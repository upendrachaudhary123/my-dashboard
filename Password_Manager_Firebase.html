<!DOCTYPE html>
<!-- saved from url=(0063)file:///C:/Users/upendrac/Downloads/password_manager%20(4).html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Manager Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .dashboard {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .form-section {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
        }

        .form-title {
            font-size: 1.3em;
            margin-bottom: 15px;
            color: #333;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 2fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 4px;
            color: #555;
            font-weight: 500;
            font-size: 0.85em;
        }

        input {
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-size: 0.9em;
            transition: border-color 0.3s;
        }

        input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 8px 20px;
            border: none;
            border-radius: 5px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
            margin-left: 10px;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-small {
            padding: 3px 6px;
            font-size: 0.75em;
            margin: 0 2px;
        }

        .btn-edit {
            background: #ffc107;
            color: #333;
            margin-right: 5px;
        }

        .btn-edit:hover {
            background: #e0a800;
        }

        .btn-delete {
            background: #dc3545;
            color: white;
        }

        .btn-delete:hover {
            background: #c82333;
        }

        .btn-toggle {
            background: #28a745;
            color: white;
            margin-right: 5px;
        }

        .btn-toggle:hover {
            background: #218838;
        }

        .table-section {
            padding: 20px;
            overflow-x: auto;
        }

        .search-box {
            margin-bottom: 15px;
        }

        .search-box input {
            width: 100%;
            padding: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        thead {
            background: #10a37f;
            color: white;
        }

        th {
            padding: 6px 8px;
            text-align: center;
            font-weight: 600;
            font-size: 0.85em;
            border: 1px solid #ffffff;
        }

        tbody tr {
            border: 1px solid #000000;
            transition: background-color 0.2s;
        }

        tbody tr:hover {
            background-color: #f0f0f0;
        }

        tbody tr:nth-child(odd) {
            background-color: #e8f5e9;
        }

        tbody tr:nth-child(even) {
            background-color: #ffffff;
        }

        td {
            padding: 4px 8px;
            border: 1px solid #000000;
            vertical-align: middle;
            font-size: 0.85em;
        }

        .sno-col {
            width: 40px;
            text-align: center;
            font-weight: 600;
        }

        .name-col {
            width: 150px;
            text-align: left;
            font-family: Arial, sans-serif;
        }

        .url-col {
            width: auto;
            text-align: left;
            font-family: Arial, sans-serif;
        }

        .username-col {
            width: 120px;
            text-align: center;
            font-family: Arial, sans-serif;
        }

        .password-col {
            width: 120px;
            text-align: center;
            font-family: Arial, sans-serif;
        }

        .actions-col {
            width: 140px;
            text-align: center;
        }

        .password-hidden {
            letter-spacing: 3px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state svg {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 0.85em;
            }

            th, td {
                padding: 8px;
            }

            .btn-small {
                padding: 4px 8px;
                font-size: 0.75em;
            }
        }

        /* Login Screen */
        #loginScreen {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        .login-card {
            background: white;
            border-radius: 20px;
            padding: 50px 40px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 90%;
        }
        .login-card h1 { font-size: 2em; margin-bottom: 8px; color: #333; }
        .login-card p { color: #888; margin-bottom: 30px; }
        .btn-google {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.2s;
            color: #333;
        }
        .btn-google:hover { border-color: #667eea; box-shadow: 0 4px 12px rgba(102,126,234,0.3); }
        .btn-google img { width: 22px; height: 22px; }
        #loginError { color: #dc3545; margin-top: 16px; font-size: 0.85em; min-height: 20px; }
        /* User bar */
        .user-bar {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 12px;
            padding: 8px 20px;
            background: #f0f0f0;
            font-size: 0.85em;
            color: #555;
        }
        .btn-signout {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 4px 12px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: 600;
        }
        .btn-signout:hover { background: #c82333; }
    </style>
    <!-- SheetJS library for Excel import -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
        import { getAuth, signInWithPopup, signOut, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

        const ALLOWED_EMAILS = [
            "cupendra9@gmail.com"
        ];

        const firebaseConfig = {
            apiKey: "AIzaSyDtMneHOvYWxoY7JBj4336nLVulbkFcMz0",
            authDomain: "password-7574c.firebaseapp.com",
            projectId: "password-7574c",
            storageBucket: "password-7574c.firebasestorage.app",
            messagingSenderId: "878122752644",
            appId: "1:878122752644:web:db3f4906c9c4a8b1e180d1"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();
        const colRef = collection(db, "credentials");

        window._fb = { db, colRef, getDocs, addDoc, updateDoc, deleteDoc, doc, collection };

        // Listen to auth state
        onAuthStateChanged(auth, (user) => {
            if (user) {
                if (ALLOWED_EMAILS.includes(user.email)) {
                    // Authorised
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('mainApp').style.display = 'block';
                    document.getElementById('userEmail').textContent = user.email;
                    window.dispatchEvent(new Event("firebaseReady"));
                } else {
                    // Not in whitelist
                    signOut(auth);
                    document.getElementById('loginScreen').style.display = 'flex';
                    document.getElementById('mainApp').style.display = 'none';
                    document.getElementById('loginError').textContent = '‚õî Access denied. Your account (' + user.email + ') is not authorised.';
                }
            } else {
                document.getElementById('loginScreen').style.display = 'flex';
                document.getElementById('mainApp').style.display = 'none';
            }
        });

        window.signInWithGoogle = () => signInWithPopup(auth, provider).catch(err => {
            document.getElementById('loginError').textContent = '‚ùå Sign-in failed: ' + err.message;
        });

        window.signOutUser = () => signOut(auth);
    </script>
</head>
<body>

    <!-- Login Screen -->
    <div id="loginScreen" style="display:flex;">
        <div class="login-card">
            <h1>üîê Password Manager</h1>
            <p>Sign in to access your credentials</p>
            <button class="btn-google" onclick="signInWithGoogle()">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                Sign in with Google
            </button>
            <div id="loginError"></div>
        </div>
    </div>

    <!-- Main App (hidden until signed in) -->
    <div id="mainApp" style="display:none;">
        <!-- User bar -->
        <div class="user-bar">
            <span>üë§ <span id="userEmail"></span></span>
            <button class="btn-signout" onclick="signOutUser()">Sign Out</button>
        </div>
        <div class="container">
        <header>
            <h1>üîê Password Manager</h1>
            <p class="subtitle">Securely manage your credentials</p>
        </header>

        <div id="statusBar" style="text-align:center; padding: 6px; font-size:0.85em; color:#888;">‚è≥ Connecting to Firebase...</div>
        <div class="dashboard">
            <div class="form-section">
                <h2 class="form-title" id="formTitle">Add New Credential</h2>
                <form id="credentialForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input type="text" id="name" placeholder="e.g., link:US(burbank)" required="">
                        </div>
                        <div class="form-group">
                            <label for="url">URL</label>
                            <input type="text" id="url" placeholder="http://10.135.4.10:1000/portal?" required="">
                        </div>
                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" id="username" placeholder="NTNET" required="">
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" id="password" placeholder="Enter password" required="">
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button type="submit" class="btn btn-primary">Save Credential</button>
                        <button type="button" class="btn btn-secondary" id="cancelBtn" style="display: none;">Cancel</button>
                        <button type="button" class="btn" onclick="importFromExcel()" style="background: #28a745;">üìÇ Import from Excel</button>
                    </div>
                </form>
            </div>

            <div class="table-section">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="üîç Search by name, URL, or username...">
                </div>
                <div id="tableContainer">
                            
            </div>
            </div>
        </div>
    </div>

        <script>
        // ‚îÄ‚îÄ Status bar helper ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function setStatus(msg, color = '#333') {
            const el = document.getElementById('statusBar');
            if (el) { el.textContent = msg; el.style.color = color; }
        }

        // ‚îÄ‚îÄ Default seed data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        const DEFAULT_CREDENTIALS = [
            { name: 'Firewall Login (US)', url: 'http://10.135.4.10:1000/portal?', username: 'NTNET', password: '' },
            { name: 'Firewall Login (UK)', url: 'http://10.133.2.5:1000/portal?0407059f401267dd', username: 'NTNET', password: '' },
            { name: 'Graphana', url: 'https://grafana.vubiquity.com', username: 'devuser', password: '' },
            { name: 'Admin UI', url: 'https://azuks-explorer-wa-v2-p001.azurewebsites.net/app/cc/list/offers', username: 'uchaudhary', password: '' },
            { name: 'Jira', url: 'Superjira / Agile jira / DCR', username: 'uchaudhary', password: '' },
            { name: 'Vubiquity', url: 'User ID', username: 'uchadhary', password: '' },
            { name: 'Adonis Prod', url: 'Application', username: 'uchaudhary', password: '' },
            { name: 'Adonis Staging', url: 'Application', username: 'uchaudhary', password: '' },
            { name: 'Intelli VU', url: 'https://intellivu-nextgen.vubiquity.com/intelli-vu/user', username: 'upendra.chaudhary@vubiquity.com', password: '' },
            { name: 'Zendesk', url: 'https://vubiquity.zendesk.com/agent/filters/11372997839761', username: 'VU ID', password: '' },
            { name: 'Confluence', url: 'https://confluence.vubiquity.com/pages', username: 'uchaudhary', password: '' },
        ];

        let credentials = [];   // { id, name, url, username, password }
        let editingIndex = -1;
        let visiblePasswords = new Set();
        let editingRow = -1;
        let fb = null;          // will be set once Firebase is ready

        // ‚îÄ‚îÄ Wait for Firebase then load ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        window.addEventListener('firebaseReady', () => {
            fb = window._fb;
            loadCredentials();
        });

        // ‚îÄ‚îÄ Load from Firestore ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        async function loadCredentials() {
            setStatus('‚è≥ Loading from Firebase...', '#888');
            try {
                const snapshot = await fb.getDocs(fb.colRef);
                credentials = [];
                snapshot.forEach(docSnap => {
                    credentials.push({ id: docSnap.id, ...docSnap.data() });
                });

                // First-time seed: if Firestore is empty, push defaults
                if (credentials.length === 0) {
                    setStatus('‚è≥ First run ‚Äî seeding default data...', '#888');
                    for (const cred of DEFAULT_CREDENTIALS) {
                        const ref = await fb.addDoc(fb.colRef, cred);
                        credentials.push({ id: ref.id, ...cred });
                    }
                }

                setStatus('‚úÖ Connected to Firebase', '#28a745');
                renderTable();
            } catch (err) {
                setStatus('‚ùå Firebase error: ' + err.message, '#dc3545');
                console.error(err);
            }
        }

        // ‚îÄ‚îÄ Save (add or update) to Firestore ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        async function saveCredential(cred, id = null) {
            const data = { name: cred.name, url: cred.url, username: cred.username, password: cred.password };
            if (id) {
                await fb.updateDoc(fb.doc(fb.db, 'credentials', id), data);
                return id;
            } else {
                const ref = await fb.addDoc(fb.colRef, data);
                return ref.id;
            }
        }

        // ‚îÄ‚îÄ Delete from Firestore ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        async function deleteFromFirestore(id) {
            await fb.deleteDoc(fb.doc(fb.db, 'credentials', id));
        }

        // ‚îÄ‚îÄ Render table ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function renderTable(filter = '') {
            const container = document.getElementById('tableContainer');
            const filtered = credentials.filter(c =>
                (c.name || '').toLowerCase().includes(filter.toLowerCase()) ||
                (c.url || '').toLowerCase().includes(filter.toLowerCase()) ||
                (c.username || '').toLowerCase().includes(filter.toLowerCase())
            );

            if (filtered.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                        </svg>
                        <h3>No credentials saved yet</h3>
                        <p>Add your first credential using the form above</p>
                    </div>`;
                return;
            }

            const tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th class="sno-col">S.No.</th>
                            <th class="name-col">Name</th>
                            <th class="url-col">URLs</th>
                            <th class="username-col">Usernames</th>
                            <th class="password-col">Passwords</th>
                            <th class="actions-col">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${filtered.map((cred, index) => {
                            const actualIndex = credentials.indexOf(cred);
                            const isVisible = visiblePasswords.has(actualIndex);
                            const isEditing = editingRow === actualIndex;
                            return `
                                <tr>
                                    <td class="sno-col">${index + 1}</td>
                                    <td class="name-col">${escapeHtml(cred.name)}</td>
                                    <td class="url-col">${escapeHtml(cred.url)}</td>
                                    <td class="username-col">${escapeHtml(cred.username)}</td>
                                    <td class="password-col ${isVisible ? '' : 'password-hidden'}">
                                        ${isVisible ? escapeHtml(cred.password) : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢'}
                                    </td>
                                    <td class="actions-col">
                                        <button class="btn btn-small btn-toggle" onclick="togglePassword(${actualIndex})">
                                            ${isVisible ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è'}
                                        </button>
                                        ${isEditing ? `
                                            <button class="btn btn-small btn-delete" onclick="deleteCredential(${actualIndex})">üóëÔ∏è</button>
                                        ` : `
                                            <button class="btn btn-small btn-edit" onclick="editCredential(${actualIndex})">‚úèÔ∏è</button>
                                        `}
                                    </td>
                                </tr>`;
                        }).join('')}
                    </tbody>
                </table>`;

            container.innerHTML = tableHTML;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text || '';
            return div.innerHTML;
        }

        function togglePassword(index) {
            if (visiblePasswords.has(index)) {
                visiblePasswords.delete(index);
            } else {
                visiblePasswords.add(index);
            }
            renderTable(document.getElementById('searchInput').value);
        }

        function editCredential(index) {
            editingIndex = index;
            editingRow = index;
            const cred = credentials[index];
            document.getElementById('name').value = cred.name;
            document.getElementById('url').value = cred.url;
            document.getElementById('username').value = cred.username;
            document.getElementById('password').value = cred.password;
            document.getElementById('formTitle').textContent = 'Edit Credential';
            document.getElementById('cancelBtn').style.display = 'inline-block';
            renderTable(document.getElementById('searchInput').value);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        async function deleteCredential(index) {
            if (confirm('Are you sure you want to delete this credential?')) {
                const cred = credentials[index];
                try {
                    setStatus('‚è≥ Deleting...', '#888');
                    await deleteFromFirestore(cred.id);
                    credentials.splice(index, 1);
                    visiblePasswords.delete(index);
                    editingRow = -1;
                    setStatus('‚úÖ Deleted', '#28a745');
                    renderTable(document.getElementById('searchInput').value);
                } catch (err) {
                    setStatus('‚ùå Delete failed: ' + err.message, '#dc3545');
                }
            }
        }

        document.getElementById('credentialForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const name     = document.getElementById('name').value.trim();
            const url      = document.getElementById('url').value.trim();
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            if (!name || !url || !username || !password) {
                alert('Please fill in all fields');
                return;
            }

            try {
                setStatus('‚è≥ Saving...', '#888');
                if (editingIndex >= 0) {
                    const existing = credentials[editingIndex];
                    await saveCredential({ name, url, username, password }, existing.id);
                    credentials[editingIndex] = { id: existing.id, name, url, username, password };
                    editingIndex = -1;
                    editingRow = -1;
                    document.getElementById('formTitle').textContent = 'Add New Credential';
                    document.getElementById('cancelBtn').style.display = 'none';
                } else {
                    const newId = await saveCredential({ name, url, username, password });
                    credentials.push({ id: newId, name, url, username, password });
                }
                setStatus('‚úÖ Saved to Firebase', '#28a745');
                renderTable(document.getElementById('searchInput').value);
                this.reset();
            } catch (err) {
                setStatus('‚ùå Save failed: ' + err.message, '#dc3545');
            }
        });

        document.getElementById('cancelBtn').addEventListener('click', function() {
            editingIndex = -1;
            editingRow = -1;
            document.getElementById('formTitle').textContent = 'Add New Credential';
            document.getElementById('credentialForm').reset();
            this.style.display = 'none';
            renderTable(document.getElementById('searchInput').value);
        });

        document.getElementById('searchInput').addEventListener('input', function() {
            renderTable(this.value);
        });

        // ‚îÄ‚îÄ Import from Excel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        function importFromExcel() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.xlsx, .xls, .csv';

            input.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = async (event) => {
                    try {
                        const data = new Uint8Array(event.target.result);
                        const workbook = XLSX.read(data, { type: 'array', raw: false, cellText: true });
                        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                        const jsonData = XLSX.utils.sheet_to_json(firstSheet, { defval: '', raw: false });

                        if (jsonData.length === 0) {
                            alert('‚ö†Ô∏è No data found in Excel file!');
                            return;
                        }

                        const detectedCols = Object.keys(jsonData[0]);

                        function getCol(row, ...names) {
                            for (const key of Object.keys(row)) {
                                const cleanKey = key.trim().toLowerCase();
                                for (const n of names) {
                                    if (cleanKey === n.toLowerCase()) return String(row[key] ?? '').trim();
                                }
                            }
                            return '';
                        }

                        let imported = 0, skipped = 0;
                        setStatus('‚è≥ Importing...', '#888');

                        for (const row of jsonData) {
                            const name     = getCol(row, 'Name', 'name', 'NAME', 'Site', 'Title');
                            const url      = getCol(row, 'URL', 'url', 'Url', 'URLs', 'Link', 'Website');
                            const username = getCol(row, 'Username', 'username', 'USERNAME', 'User', 'Email', 'Login');
                            const password = getCol(row, 'Password', 'password', 'PASSWORD', 'Pass', 'Pwd');

                            if (name) {
                                const cred = { name, url: url || '', username: username || '', password: password || '' };
                                const newId = await saveCredential(cred);
                                credentials.push({ id: newId, ...cred });
                                imported++;
                            } else {
                                skipped++;
                            }
                        }

                        if (imported > 0) {
                            renderTable(document.getElementById('searchInput').value);
                            setStatus(`‚úÖ Imported ${imported} credential(s) to Firebase`, '#28a745');
                            alert(`‚úÖ Successfully imported ${imported} credential(s)!${skipped > 0 ? '\n‚ö†Ô∏è Skipped ' + skipped + ' rows with no Name.' : ''}\n\nDetected columns: ${detectedCols.join(', ')}`);
                        } else {
                            setStatus('‚ùå Import failed ‚Äî no valid rows', '#dc3545');
                            alert(`‚ùå No valid credentials found!\n\nDetected columns: ${detectedCols.join(', ')}\n\nExpected at least a "Name" column.`);
                        }
                    } catch (error) {
                        setStatus('‚ùå Import error: ' + error.message, '#dc3545');
                        alert('‚ùå Error reading file: ' + error.message);
                    }
                };

                reader.readAsArrayBuffer(file);
            };

            input.click();
        }
    </script>

    </div>
</body></html>